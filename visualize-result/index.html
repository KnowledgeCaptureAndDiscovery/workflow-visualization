<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<!-- <link rel="icon" type="image/png" href=""> -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Workflow Dashboard</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
	<meta name="viewport" content="width=device-width" />

	<!-- Icons -->
	<link rel="stylesheet" href="../assets/css/pe-icon-7-stroke.css"/>

	<!-- Semantic UI CSS -->
	<link rel="stylesheet" href="../assets/css/semantic.min.css"/>

	<!-- Custom Stylesheet -->
	<link rel="stylesheet" href="../global.css"/>
	<link rel="stylesheet" href="styles.css"/>

	<!-- Range Slider Plugin -->
	<link rel="stylesheet" href="../assets/css/range.normalize.css">
	<link rel="stylesheet" href="../assets/css/range.css">
	<link rel="stylesheet" href="../assets/css/range.skinFlat.css">
</head>

<body class="dimmable" style="display: none">

	<!-- Sidebar Menu for Mobile Sites -->
	<div class="ui left vertical inverted sidebar menu blue toc">
		<a href="../" class="item title">
			<b>Workflow</b>
		</a>
		<a class="item active">
			<i class="pe-7s-graph"></i> <span>Visualize Result</span>
		</a>
		<a href="../inspect-parameters/" class="item">
			<i class="pe-7s-edit"></i> <span>Inspect Parameters</span>
		</a>
		<a href="../compare-workflows/" class="item">
			<i class="pe-7s-graph3"></i> <span>Compare Workflows</span>
		</a>
	</div>

	<!-- Navigation Bar for Mobile Sites -->
	<div class="ui fixed inverted main menu">
		<div class="ui container">
			<a class="launch icon item">
				<i class="content icon"></i>
			</a>
	
			<div class="item">
				Visualize Result
			</div>
		</div>
	</div>

	<!-- Main Content -->
	<div class="pusher full height">
		<!-- Placeholder for Navigation Bar for Desktop Sites -->
		<div class="ui visible left vertical inverted sidebar menu blue toc-copy"></div>

		<!-- The Real Main Content -->
		<div class="main-content">
			<!-- Main Content Header -->
			<div class="ui vertical segment header-content">
				<div class="ui container">
					<div class="ui stackable grid">
						<div class="nine wide column">
							<h1 class="ui header">
							Visualize Result
								<div class="sub header">
									Visually interpret a single workflow result.
								</div>
							</h1>
						</div>
						<div class="seven wide column">
							<div class="ui basic buttons">
								<div class="ui fluid pointing dropdown button header-dropdown">
									<span class="text">Data Selection</span>
									<i class="icon dropdown"></i>
									<div class="menu">
										<div class="header"> Sample CSV Data </div>
										<div class="item" data-value="https://vincentarelbundock.github.io/Rdatasets/csv/datasets/iris.csv">Iris</div>
										<div class="item" data-value="https://vincentarelbundock.github.io/Rdatasets/csv/datasets/infert.csv">Infertility</div>
										<div class="item" data-value="https://vincentarelbundock.github.io/Rdatasets/csv/datasets/chickwts.csv">Chick Weights</div>

										<div class="divider"></div>

										<div class="header"> Sample ARFF Data </div>
										<div class="item" data-value="https://yjy0625.github.io/workflow-visualization/data/contact-lenses.arff">Contact Lenses</div>
										<div class="item" data-value="https://yjy0625.github.io/workflow-visualization/data/diabetes.arff">Diabetes</div>
										<div class="item" data-value="https://yjy0625.github.io/workflow-visualization/data/weather.arff">Weather</div>

										<div class="divider"></div>

										<div class="header"> Other Options </div>
										<div class="item" data-value="upload">Upload Data</div>
									</div>
								</div>
								<button class="ui icon look disabled button">
									<i class="download icon"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Graph Content -->
			<div class="graphs ui container">
				<div class="ui stackable two column masonry grid graph-content">
					<!-- Different Graph Modules Start Here -->

					<div class="column basic">
						<div class="ui fluid card">
							<div class="content">
								<div class="header">
									Basic Information
								</div>
								<div class="meta">
									Basic statistical information of the data.
								</div>
							</div>
							<div class="content">
								<span>Column and Row Count</span>
								<div class="ui two statistics">
									<div class="ui statistic col-count">
										<div class="value">-</div>
										<div class="label">Columns</div>
									</div>
									<div class="ui statistic row-count">
										<div class="value">-</div>
										<div class="label">Data Points</div>
									</div>
								</div>
							</div>
							<div class="content">
								<div class="toggle-container">
									<div>Column Summary</div>
									<div class="ui fitted toggle checkbox">
										<input type="checkbox">
										<label></label>
									</div>
								</div>
								<table class="ui basic unstackable table">
									<thead>
										<th>Column Name</th>
										<th>Data Type</th>
									</thead>
									<tbody class="col-type">
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<div class="column univariate">
						<div class="ui fluid card">
							<div class="content">
								<div class="header">
									Univariate Analysis
								</div>
								<div class="meta">
									Basic statistics and distribution analysis of a single column in the data.
								</div>
								<div class="col-dropdown">
									<select class="ui fluid dropdown">
										<option value="">Select Column</option>
									</select>
								</div>
							</div>
							<div class="content has-menu">
								<div class="ui secondary pointing two item menu">
									<a class="active item">Box Plot</a>
									<a class="item">Histogram</a>
									<a class="item">Pie Chart</a>
									<a class="item">Column Chart</a>
								</div>
								<div class="box-plot">
									<div class="chart image"></div>
									<table class="ui basic unstackable table">
										<thead>
											<th>Property</th>
											<th>Value</th>
										</thead>
										<tbody></tbody>
									</table>
								</div>
								<div class="histogram">
									<div class="chart image"></div>
									<div class="ui divider"></div>
									<span>Number of Bins</span>
									<input class="ui range"></input>
								</div>
								<div class="pie-chart">
									<div class="chart image"></div>
								</div>
								<div class="column-chart">
									<div class="chart image"></div>
								</div>
							</div>
						</div>
					</div>

					<div class="column bivariate">
						<div class="ui fluid card">
							<div class="content">
								<div class="header">
									Bivariate Analysis
								</div>
								<div class="meta">
									Comparison and relationship analysis on two columns of data.
								</div>
								<div class="col-dropdown">
									<select class="ui fluid dropdown">
										<option value="">Select Column</option>
									</select>
									<div class="ui horizontal divider">
										<i class="resize vertical switch icon"></i>
									</div>
									<select class="ui fluid dropdown">
										<option value="">Select Column</option>
									</select>
								</div>
							</div>
							<div class="content has-menu">
								<div class="ui secondary pointing two item menu">
									<a class="active item">Scatter Plot</a>
									<a class="item">Line Chart</a>
									<a class="item">Stacked Histogram</a>
									<a class="item">Donut Chart</a>
									<a class="item">Stacked Column Chart</a>
								</div>
								<div class="scatter-plot">
									<div class="chart image"></div>
									<div class="ui divider"></div>
									<div class="toggle-container">
										<div>Regression</div>
										<div class="ui fitted toggle checkbox">
											<input type="checkbox">
											<label></label>
										</div>
									</div>
									<select class="ui fluid dropdown">
										<option value="linear">Linear</option>
										<option value="polynomial">Quadratic</option>
										<option value="exponential">Exponential</option>
										<option value="logarithmic">Logarithmic</option>
										<option value="power">Power</option>
									</select>
								</div>
								<div class="line-chart">
									<div class="chart image"></div>
								</div>
								<div class="stacked-histogram">
									<div class="chart image"></div>
									<div class="ui divider"></div>
									<span>Number of Bins</span>
									<input class="ui range"></input>
								</div>
								<div class="donut-chart">
									<div class="chart image"></div>
								</div>
								<div class="stacked-column-chart">
									<div class="chart image"></div>
								</div>
							</div>
						</div>
					</div>

					<!-- Different Graph Modules End Here -->
				</div>
			</div>
		</div>
	</div>

	<!-- Data Upload Modal -->
	<div class="ui modal upload">
	  <div class="header">
		Upload Data
	  </div>
	  <div class="content">
		<div class="description">
			<div class="box">
				<!-- Drag and Drop Box -->
				<div class="box__input">
					<svg class="box__icon" xmlns="http://www.w3.org/2000/svg" width="50" height="43" viewBox="0 0 50 43"><path d="M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"></path></svg>
					<input class="box__file" type="file" name="files[]" id="file" multiple />
					<label for="file"><strong>Choose a file</strong><span class="box__dragndrop"> or drag it here</span>.</label>
				</div>

				<!-- State Indicators -->
				<div class="box__uploading">Uploading&hellip;</div>
				<div class="box__success">Done!</div>
				<div class="box__error">Error! <span></span> <br><br><button class="ui button box__restart">Try Again</button></div>
			</div>
		</div>
	  </div>
	  <div class="actions">
		<div class="ui black deny button">
		  Cancel
		</div>
	  </div>
	</div>

	<!-- Error Message Modal -->
	<div class="ui small modal errmsg">
		<div class="header">Error</div>
		<div class="content">
			<div class="description"></div>
		</div>
		<div class="actions">
			<div class="ui primary right ok button">
				OK
			</div>
		</div>
	</div>

	<!-- Loader -->
	<div class="ui active dimmer">
		<div class="ui text loader">Loading</div>
	</div>

</body>

<!-- jQuery -->
<script type="text/javascript" src="../assets/js/jquery-1.10.2.js"></script>

<!-- Semantic UI JS -->
<script type="text/javascript" src="../assets/js/semantic.min.js"></script>

<!-- Div Resize Event JS -->
<script type="text/javascript" src="../assets/js/resize.min.js"></script>

<!-- Masonry JS -->
<script type="text/javascript" src="../assets/js/masonry.min.js"></script>

<!-- Range Slider Plugin -->
<script type="text/javascript" src="../assets/js/range.min.js"></script>

<!-- D3 Visualization Library -->
<script type="text/javascript" src="../assets/js/d3.min.js"></script>

<!-- DSV Parsing JS -->
<script type="text/javascript" src="../assets/js/papaparse.min.js"></script>

<!-- Highcharts -->
<script type="text/javascript" src="../assets/js/highcharts.js"></script>
<script type="text/javascript" src="../assets/js/highcharts-more.js"></script>
<script type="text/javascript" src="../assets/js/highcharts-drilldown.js"></script>

<!-- Regression Library -->
<script type="text/javascript" src="../assets/js/regression.js"></script>

<!-- Custom Script -->
<script type="text/javascript" src="script.js"></script>
<script type="text/javascript" src="drag-and-drop.js"></script>

<!-- Graph Types-->
<script src="graphs/basic.js" type="text/javascript"></script>

<script src="graphs/univariate.js" type="text/javascript"></script>
<script src="graphs/univariate/boxplot.js" type="text/javascript"></script>
<script src="graphs/univariate/histogram.js" type="text/javascript"></script>
<script src="graphs/univariate/piechart.js" type="text/javascript"></script>
<script src="graphs/univariate/columnchart.js" type="text/javascript"></script>

<script src="graphs/bivariate.js" type="text/javascript"></script>
<script src="graphs/bivariate/scatterplot.js" type="text/javascript"></script>
<script src="graphs/bivariate/linechart.js" type="text/javascript"></script>
<script src="graphs/bivariate/stackedhistogram.js" type="text/javascript"></script>
<script src="graphs/bivariate/donutchart.js" type="text/javascript"></script>
<script src="graphs/bivariate/stackedcolumnchart.js" type="text/javascript"></script>

<!-- Initialization Script -->
<script type="text/javascript">
	$(document).ready(function(){
		/* Hide all menus if url indicates embed mode */
		var encodedUrl = getParameterByName("url");
		if(encodedUrl != null) {
			$("body").css("background-color", "white");
			$(".full.height").css("background-color", "white");
			$(".main-content").css("margin", "0").css("background", "none");
			$(".toc").hide();
			$(".toc-copy").hide();
			$(".inverted.main.menu").hide();
			$(".header-content").hide();
		}

		/* Hide All Graphs */
		$(".graph-content > .column").addClass("hidden");

		/* Initialize Masonry */
		$(".masonry.grid").masonry({
			itemSelector: '.column:not(.ui)',
			percentPosition: true
		});
		$('.masonry.grid .column').resize(function() {
			$(".masonry.grid").masonry('layout');
		});

		/* Show Body */
		$("body").show();

		/* Create a copy of sidebar menu for desktop */
		$(".toc-copy").html($(".toc").html());

		/* Add sidebar animation for mobile sites */
		$(".launch.icon").click(function(){
			$(".sidebar.toc").sidebar('toggle');
		});

		/* Load Chart Types */
		var chartTypes = [];
		$(".graph-content > .column").each(function() {
			var classNames = $(this)
				.attr("class")
				.split(' ')
				.filter(function(val) {
					return val != "column"
						&& val != "hidden";
				});
			for(var ix in classNames) {
				chartTypes.push(classNames[ix]);
			}
		});

		/* Define Draw Charts Function */
		var drawCharts = function(raw) {
			Dashboard.init(raw, chartTypes);
			Dashboard.draw();

			$(".ui.look.button").click(function () {
				saveFile('data.txt', raw);
			});
			$(".ui.look.button").removeClass("disabled");

			$(".ui.modal").modal('hide');

			$(".masonry.grid").masonry('layout');
		}

		/* Download Functionality */
		var saveFile = function(filename, data) {
			var blob = new Blob([data], {type: 'text/csv'});
			if(window.navigator.msSaveOrOpenBlob) {
				window.navigator.msSaveBlob(blob, filename);
			}
			else{
				var elem = window.document.createElement('a');
				elem.href = window.URL.createObjectURL(blob);
				elem.target = '_blank';
				elem.download = filename;
				document.body.appendChild(elem);
				elem.click();        
				document.body.removeChild(elem);
			}
		}

		/* Data Selection Dropdown */
		$('.header-dropdown').dropdown('setting', 'onChange', function(){
			var newValue = $('.header-dropdown').dropdown('get value');
			if(newValue == "upload") {
				DragAndDrop.init(drawCharts);
				$(".ui.upload.modal").modal('setting', {
					closable  	: false,
					onDeny		: function() {
						$(".header-dropdown").dropdown('restore defaults');
						$(".graph-content > .column").addClass("hidden");
						$(".ui.look.button").addClass("disabled");
					}
				}).modal("show");
			}
			else if(newValue != "") {
				$.ajax({
					type: 'GET',
					url: newValue,
					dataType: "text",
					success: function(raw) {
						drawCharts(raw);
					}
				});
			}
		});

		/* Disable file upload option if necessary */
		var div = document.createElement('div');
		var isAdvancedUpload = (
			('draggable' in div) 
			|| ('ondragstart' in div && 'ondrop' in div)
		) && 'FormData' in window && 'FileReader' in window;
		if(!isAdvancedUpload) {
			$(".header-dropdown .item[data-value='upload']").addClass("disabled");
		}

		/* Function that analyzes url parameters */
		/* Code source: http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript */
		function getParameterByName(name, url) {
			if (!url) url = window.location.href;
			name = name.replace(/[\[\]]/g, "\\$&");
			var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
			    results = regex.exec(url);
			if (!results) return null;
			if (!results[2]) return '';
			return decodeURIComponent(results[2].replace(/\+/g, " "));
		}

		/* Analyze url parameters, show visualizations if needed */
		if(encodedUrl != null) {
			var urlSource = decodeURIComponent(encodedUrl);

			$.ajax({
				type: 'GET',
				url: urlSource,
				dataType: "text",
				success: function(raw) {
					drawCharts(raw);
				}
			});
		}

		$(".dimmable .ui.dimmer").removeClass("active");
	});
</script>

</html>